%% typing system
%%%% Remove the arrows and move the annotation on the quantifier to gain
%%%% a little space
%% proof that  cut elim maintains typing

\section{Typing decorated terms with MLL}

We first define the language of formulas that we will use for the typing system:
\begin{definition}
The language of formulas is given by the following grammar:
\begin{align*}
A,B::=	&\;\; 1 \;\; | \;\; \bot							& \text{neutrals}\\
	|	&\;\; u											& u\in N\;\;\;\text{atoms}\\
	|	&\;\; A \logtensor B \;\; | \;\; A \logpar B		& \text{tensor and par}\\
	|	&\;\; \exists_ut.A \;\; | \;\; \forall_ut.A		& t,u\in N\;\;\; \text{existential and universal quantifiers}
\end{align*}
\end{definition}

It is based on the structure of MLL, with atoms formed by the names traded by $\pi$-terms, and first order quantification annotated by those names and quantifying on those names. With that, we give a typing system in the form of deduction rules, of which the first 6 are exactly the rules for MLL if considering only the formulas in the logic part of the rules: 

\begin{definition}
The typing system is given by the following rules, where $\Gamma,\Delta$ are partial functions from $V$ the set of variables to the language of formulas, and where $\Gamma$ and $\Delta$ do not share any variable name when they occur as two hypothesis of the same rule (PARA and CUT):\\~\\
\indent\textbox{
	Rules for neutral elements:\\~\\
	\begin{prooftree}\infer0[NOP]{0_x \vdash x:1}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P \vdash \Gamma\;\;\;\; x\not\in\Gamma}
		\infer1[BOT]{\epsilon_x.P \vdash \Gamma,x:\bot}\end{prooftree}\hfill
	\begin{prooftree}\infer0[AX]{x \tto y \vdash x:E^\bot,y:E}\end{prooftree}\hfill~\\~\\
	Construction rules:\\~\\
	\begin{prooftree}\hypo{P \vdash \Gamma,x:E}
		\hypo{Q \vdash \Delta,x:F}
		\infer2[PARA]{P |_x Q \vdash \Gamma,\Delta,x:E \logtensor F}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P \vdash \Gamma,x:E,y:F}
		\infer1[LAM]{\lambda_xy.P \vdash \Gamma,x:E \logpar F}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P \vdash \Gamma,x:E}
			\hypo{Q \vdash \Delta,x:E^\bot}
		\infer2[CUT]{P||_xQ \vdash \Gamma,\Delta}\end{prooftree}\hfill~\\~\\
	Action rules:\\~\\
	\begin{prooftree}\hypo{P \vdash \Gamma,x:A[v/t]^\bot}
		\infer1[IN]{\bar{u}_x\langle v\rangle.P \vdash \Gamma,x:\exists_u t.A^\bot}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P \vdash \Gamma,x:A\;\;\;t\not\in\Gamma}
		\infer1[OUT]{u_x(t).P \vdash \Gamma,x:\forall_u t.A}\end{prooftree}\hfill~\\~\\
	Nu rule:\\~\\
	\begin{prooftree}\hypo{P \vdash \Gamma\;\;\;\; u\text{ does not appear in any formula of }\Gamma}
		\infer1[NU]{(\nu u)P \vdash \Gamma}\end{prooftree}
}
\end{definition}

One important thing to note here, as explained before, is that for PARA and CUT rules, $\Gamma$ and $\Delta$ are disjoint. The other important thing is that the synchronization construction becomes a CUT operation in the typing system. This rule has elimination transformations, given by the relations $\to$ and $\succ$ defined in \ref{reduction}. Properties we would like to emerge from such a construction would be that the arrows preserve typing, and that their application for cut elimination terminates and actually eliminates cuts.

\textcolor{red}{Prop 1: Preserv type.\\
Prop 2: termine.\\
Observer la non élimination des coupures\\
Ajouter $\leadsto$ et $\succsim$ et noter que les deux preuves précédentes ne changent pas\\
Prop 3: $\leadsto$ and $\succsim$ élimine les coupues.}\\~\\ %TODO

\textcolor{red}{TEMPORARY: MOVED THAT FROM DEFINITION IN PART 1} %TODO
And we extend it into $\succsim$ as follows, allowing for it to act on (and under) action prefixes:
\begin{flalign*}
u_x(t).P||_yQ &\succsim u_x(t).(P||_yQ) &\text{symmetric in }||\;\;\;6d\\
\bar{u}_x\langle v \rangle.P||_yQ &\succsim \bar{u}_x\langle v \rangle.(P||_yQ) &\text{symmetric in }||\;\;\;6e
\end{flalign*}
Relation $\to$ is also extended into $\leadsto$ by allowing it to act under action prefixes (no specific rule added).\\~\\

\textcolor{red}{TEMPORARY: MOVED THAT} %TODO
And we also extend it into $\cong$ by allowing $\alpha,\beta$ to be action prefixes in rules $c,d$:
\[\alpha_\cdot,\beta_\cdot \in \{\epsilon_\cdot,\lambda_\cdot z,u_\cdot(t),\bar{u}_\cdot\langle v\rangle\};\]
as well as in rule $f$:
\[\alpha_\cdot \in \{\epsilon_\cdot,\lambda_\cdot z,v_\cdot(t),\bar{v}_\cdot\langle w\rangle, u\neq v, u\neq t,u\neq w\}.\]



\remark With no exponential, it is no surprise that cut elimination terminates.\\

\textcolor{red}{Remark the other way around: we need commuting action prefixes here, but this hypothesis could be relaxed by proving cut elimination in quantifier-closed context. The proof would then be quite more technical.}\\ %TODO

\textcolor{red}{Also, insert here the followed example from the other paper that is to be shown in part 1, to show here that it is not only reducing well, but also well-typed. (Question for later: Is there a term, simplest possible if exists, that reduces well without typing, but cannot be well-typed?)} %TODO