\documentclass[a4paper,12pt]{book}

\usepackage{mystyle}

\title{Continuations, mobile processes, all the things...}
\author{Julien Gabet}
\date{Mars-June, 2018}

\begin{document}

\everymath{\displaystyle}

\maketitle

\chapter*{Memo/garbage part}

\noindent$M,N::= x ; \lambda x.M ; MN$\\
$(\lambda x.M)N \rightarrow_\beta M[N/x]$\hfill terms tend to get bigger\\
~\\
If $C[\;]$ is a context, and $M\rightarrow_\beta N$\\
\;\; then $C[M]\rightarrow_\beta C[N]$

\noindent\hrulefill

\noindent$P,Q::= u(xy).P ; \bar{u}xy.P ; P|Q ; (\nu x)P | !P$\\
$u(xy).P | \bar{u}ab.Q \rightarrow P[a/x,b/y] | Q$\\
~\\
If $P\rightarrow Q$ then $C[P]\rightarrow C[Q]$\hfill (with necessary hypothesis on context $C$)\\
If $P\equiv P'\rightarrow Q\equiv Q'$ then $P\rightarrow Q$

\noindent\hrulefill

\noindent Krivine Abstract Machine (KAM)\\
$M\star\Pi\star\EE$\\
\begin{align*}
MN\star\Pi\star\EE &\rightarrow M\star(N,\EE).\Pi\star\EE\\
\lambda x.M\star(N,\EE).\Pi\star\FF &\rightarrow M\star\Pi\star\FF,s\mapsto(N,\EE)\\
x\star\Pi\star\EE,x\mapsto(M,\FF) &\rightarrow M\star\Pi\star\FF
\end{align*}
For exponentials:\\
\indent$!P\simeq!P|!P$\\
\indent$(\nu u)!u(x).P\simeq 0$\\
idea: $!P|Q\simeq!P|!P|Q \;\; \forall Q$

\noindent\hrulefill

\begin{align*}
\llbracket (M,\EE).\Pi \rrbracket_u &= (\nu m)(\nu v)(\bar{u}mv|!m(x)\llbracket M,\EE\rrbracket_x|\llbracket\Pi\rrbracket_v)\\
\llbracket M,\left( x_i\mapsto(M_i,\EE_i)\right)_{i=1..k}\rrbracket_u &= (\nu x_1)\cdots(\nu x_k)(\llbracket M\rrbracket_u|!x_1(u).\llbracket M_1,\EE_1\rrbracket_u | \cdots)\\
\llbracket MN \rrbracket_u &= (\nu v) (\nu n) (\llbracket M \rrbracket_v | \bar{v}nu|!n(x).\llbracket N\rrbracket_x)\\
\llbracket\lambda x.M\rrbracket_u &= u (xv).\llbracket M\rrbracket_v\\
\llbracket x\rrbracket_u &= \bar{x}u
\end{align*}
~\\
We want $M\star\Pi\star\EE\rightarrow M'\star\Pi'\star\EE'$ iff $\llbracket M,\EE\rrbracket_u|\llbracket\Pi\rrbracket_u\rightarrow\llbracket M',\EE'\rrbracket_v|\llbracket\Pi'\rrbracket_v$

~\\

\begin{itemize}
	\item equiv $\simeq$ bisimulation
	\item the traduction goes well
\end{itemize}
\newpage

\begin{definition}
A binary relation $S$ is a reduction bisimulation if, forall $(P,Q)\in S$\\
\begin{itemize}
	\item[(1)] $P\xrightarrow{\tau}P'$ implies $Q\xrightarrow{\tau}Q'$ for some $Q'$ with $(P',Q')\in S$
	\item[(2)] $Q\xrightarrow{\tau}Q'$ implies $P\xrightarrow{\tau}P'$ for some $P'$ with $(P',Q')\in S$
\end{itemize}
\end{definition}


\begin{definition}[Observability:]\\
$P\downarrow_{x}$ if $P$ can make an input action of subject $x$\\
$P\downarrow_{\bar{x}}$ if $P$ can make an output action of subject $x$.
\end{definition}


\begin{definition}[Image-finite process:]\\
$P$ is image-finite if, for all derivative $Q$ of $P$ and any action $\alpha, \exists n\geq0$ and $Q_1,\cdots Q_n$ such that $Q\xRightarrow{\alpha}Q'$ implies $Q'=Q_i$ for some $i$.\\
where $\Rightarrow$ is the reflexive transitive closure of $\xrightarrow{\tau}$ and $\xRightarrow{\alpha}$ is $\Rightarrow\xrightarrow{\alpha}\Rightarrow$ for some action $\alpha$.
\end{definition}

\newpage
\noindent{\Large\underline{Rules for base-$\pi$}}\\
\underline{Value-typing}\\~\\
	\indent\textbox{\begin{prooftree}\infer0[TV-BASVAL]{\Gamma \vdash basval:B}\end{prooftree}\hfill
	\begin{prooftree}\infer0[TV-NAME]{\Gamma,x:T \vdash x:T}\end{prooftree}\hfill~}\\~\\
\underline{Process typing }\\~\\
\indent\textbox{
	\begin{prooftree}\hypo{\Gamma \vdash P:\diamondsuit}
		\hypo{\Gamma \vdash Q:\diamondsuit}
		\infer2[T-PAR]{\Gamma \vdash P|Q:\diamondsuit}\end{prooftree}\hfill
	\begin{prooftree}\hypo{\Gamma \vdash P:\diamondsuit}
		\hypo{\Gamma \vdash Q:\diamondsuit}
		\infer2[T-SUM]{\Gamma \vdash P+Q:\diamondsuit}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{\Gamma \vdash v:\sharp T}
		\hypo{\Gamma \vdash w:\sharp T}
		\hypo{\Gamma \vdash P:\diamondsuit}
		\infer3[T-MAT]{\Gamma \vdash [v=w]P:\diamondsuit}\end{prooftree}\hfill
	\begin{prooftree}\infer0[T-NIL]{\Gamma \vdash 0:\diamondsuit}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{\Gamma \vdash P:\diamondsuit}
		\infer1[T-REP]{\Gamma \vdash !P:\diamondsuit}\end{prooftree}\hfill
	\begin{prooftree}\hypo{\Gamma,x:L \vdash P:\diamondsuit}
		\infer1[T-RES]{\Gamma \vdash (\nu x:L)P:\diamondsuit}\end{prooftree}\hfill
	\begin{prooftree}\hypo{\Gamma \vdash P:\diamondsuit}
		\infer1[T-TAU]{\Gamma \vdash \tau.P:\diamondsuit}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{\Gamma \vdash v:\sharp T}
		\hypo{\Gamma,x:T \vdash P:\diamondsuit}
		\infer2[T-INP]{\Gamma \vdash v(x).P:\diamondsuit}\end{prooftree}\hfill
	\begin{prooftree}\hypo{\Gamma \vdash v:\sharp T}
		\hypo{\Gamma \vdash w:T}
		\hypo{\Gamma \vdash P:\diamondsuit}
		\infer3[T-OUT]{\Gamma \vdash \bar{v}w.P:\diamondsuit}\end{prooftree}\hfill~
}\\
\begin{flalign*}\text{Types: }S,T::= &V \text{ value type}&\\
	|&L \text{ link type}&\\
	|&\diamond \text{ behaviour type}&
\end{flalign*}
Value types: $V::=B$ basic type\\
Link types: $L::=\sharp V$ connexion type\\
Environments: $\Gamma::=\Gamma,x:L|\Gamma,x:V|\emptyset$\\~\\
\underline{Transitions for base-$\pi$}\\~\\
\indent\textbox{
	\begin{prooftree}\infer0[OUT]{\bar{a}w.P\xrightarrow{\bar{a}w}P}\end{prooftree}\hfill
	\begin{prooftree}\infer0[INP]{a(x).P\xrightarrow{aw}P\{w/x\}}\end{prooftree}\hfill
	\begin{prooftree}\infer0[TAU]{\tau P\xrightarrow{\tau}P}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{P\xrightarrow{\alpha}P'}
		\infer1[MAT]{[x=x]P\xrightarrow{\alpha}P'}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P\xrightarrow{\alpha}P'}
		\infer1[SUM-L]{P+Q\xrightarrow{\alpha}P'}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P\xrightarrow{\alpha}P'}
		\infer1[PAR-L $(bn(\alpha)\cap fn(Q)=\emptyset)$]{P|Q\xrightarrow{\alpha}P'|Q}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{P\xrightarrow{(\nu\widetilde{z}:\widetilde{T})\bar{a}v}P'}
		\hypo{Q\xrightarrow{av}Q'}
		\infer2[COMM-L $(\widetilde{z}\cap fn(Q)=\emptyset)$]{P|Q\xrightarrow{\tau}(\nu\widetilde{z}:\widetilde{T})(P'|Q')}\end{prooftree}\\~\\
	\begin{prooftree}\hypo{P\xrightarrow{\alpha}P'}
		\infer1[RES $(x\not\in n(\alpha))$]{(\nu x:T)P\xrightarrow{\alpha}(\nu x:T)P'}\end{prooftree}\hfill
	\begin{prooftree}\hypo{P\xrightarrow{\alpha}P'}
		\infer1[REP-ACT]{!P\xrightarrow{\alpha}P'|!P}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{P\xrightarrow{(\nu\widetilde{z}:\widetilde{T})\bar{a}v}P'}
		\infer1[OPEN $(x\in fn(v), x\not\in\{\widetilde{z},a\})$]{(\nu x:T)P\xrightarrow{(\nu\widetilde{z}:\widetilde{T},x:T)}P'}\end{prooftree}\\~\\
	\begin{prooftree}\hypo{P\xrightarrow{(\nu\widetilde{z}:\widetilde{T})\bar{a}v}P'}
		\hypo{P\xrightarrow{av}P''}
		\infer2[REP-COMM $(\widetilde{z}\cap fn(P)=\emptyset)$]{!P\xrightarrow{\tau}(\nu\widetilde{z}:\widetilde{T})(P'| P'')|!P}\end{prooftree}\\~\\
	\begin{prooftree}\hypo{\text{Si $v$ n'est pas un nom}}
		\infer1[OUTERR]{\bar{v}w.P\xrightarrow{\tau}wrong}\end{prooftree}\hfill
	\begin{prooftree}\hypo{\text{Si $v$ n'est pas un nom}}
		\infer1[INPERR]{v(x).P\xrightarrow{\tau}wrong}\end{prooftree}\hfill~\\~\\
	\begin{prooftree}\hypo{\text{Si $v$ ou $w$ n'est pas un nom}}
		\infer1[MATERR]{[v=w]P\xrightarrow{\tau}wrong}\end{prooftree}
}

\begin{flalign*}\text{simply-typed $\pi$-calculus: same but with value types } V::= &B\text{ basic type} &\\
	|&L \text{ link type, allowing to pass links} &
\end{flalign*}

\newpage
\noindent{\Large\underline{i/o types}}\\
\underline{Grammar:} same + $L::= iV | oV$\hfill (input and output capabilities)\\
\underline{Subtyping rules}\\~\\
\indent\textbox{
	\begin{prooftree}\infer0[SUB-REFL]{T\leq T}\end{prooftree}\hfill
	\begin{prooftree}\hypo{S\leq S'}
		\hypo{S'\leq T}
		\infer2[SUB-TRANS]{S\leq T}\end{prooftree}\hfill~\hfill~\\~\\~\\
	\begin{prooftree}\infer0[SUB-$\sharp$I]{\sharp T\leq iT}\end{prooftree}\hfill
	\begin{prooftree}\infer0[SUB-$\sharp$O]{\sharp T\leq oT}\end{prooftree}\hfill~\hfill~\\~\\
	\begin{prooftree}\hypo{S\leq T}
		\infer1[SUB-II]{iS\leq iT}\end{prooftree}\hfill
	\begin{prooftree}\hypo{S\leq T}
		\infer1[SUB-OO]{oT\leq oS}\end{prooftree}\hfill~\hfill~\\~\\
	\begin{prooftree}\hypo{S\leq T}
		\hypo{T\leq S}
		\infer2[SUB-BS]{\sharp T\leq\sharp S}\end{prooftree}
}\\~\\
\underline{Typing rules}\\~\\
\indent\textbox{
	\begin{prooftree}\hypo{\Gamma \vdash a:iS}
		\hypo{\Gamma,x:S \vdash P:\diamondsuit}
		\infer2[T-INPS]{\Gamma \vdash a(x).P:\diamondsuit}\end{prooftree}\hfill replaces T-INP\\~\\
	\begin{prooftree}\hypo{\Gamma \vdash a:oT}
		\hypo{\Gamma \vdash w:T}
		\hypo{\Gamma \vdash P:\diamondsuit}
		\infer3[T-OUTS]{\Gamma \vdash \bar{a}w.P:\diamondsuit}\end{prooftree}\hfill replaces T-OUT\\~\\
	\begin{prooftree}\hypo{\Gamma \vdash v:S}
		\hypo{S\leq T}
		\infer2[SUBSUMPTION]{\Gamma \vdash v:T}\end{prooftree}
}\\~\\

\noindent\hrulefill

\noindent{\Large\underline{Linear types}}\\
~\\
\indent fill this in later
~\\
~\\
TODO: results on i/o and i/o-lin
\end{document}